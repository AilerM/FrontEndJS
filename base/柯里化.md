## æŸ¯é‡ŒåŒ–(currying)

### ç›®å½•
- ä¸€ã€æŸ¯é‡ŒåŒ–å®šä¹‰
- äºŒã€æŸ¯é‡ŒåŒ–æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ
- ä¸‰ã€æŸ¯é‡ŒåŒ–æœ‰ç”¨å—
- å››ã€æ€»ç»“

### ä¸€ã€æŸ¯é‡ŒåŒ–å®šä¹‰

>å¯ä»¥ç†è§£ä¸ºæå‰æ¥æ”¶éƒ¨åˆ†å‚æ•°ï¼Œå»¶è¿Ÿæ‰§è¡Œï¼Œä¸ç«‹å³è¾“å‡ºç»“æœï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ¥å—å‰©ä½™å‚æ•°çš„å‡½æ•°ã€‚ä¹Ÿè¢«ç§°ä¸ºéƒ¨åˆ†è®¡ç®—å‡½æ•°ã€‚æ‰€è°“â€œæŸ¯é‡ŒåŒ–â€å°±æ˜¯ä½¿å‡½æ•°ç†è§£å¹¶å¤„ç†éƒ¨åˆ†åº”ç”¨ã€‚

>Curryingæ¦‚å¿µå…¶å®å¾ˆç®€å•ï¼Œåªä¼ é€’ç»™å‡½æ•°ä¸€éƒ¨åˆ†å‚æ•°æ¥è°ƒç”¨å®ƒï¼Œè®©å®ƒè¿”å›ä¸€ä¸ªå‡½æ•°å»å¤„ç†å‰©ä¸‹çš„å‚æ•°ã€‚

>curryingåˆç§°éƒ¨åˆ†æ±‚å€¼ã€‚ä¸€ä¸ªcurryingçš„å‡½æ•°é¦–å…ˆä¼šæ¥å—ä¸€äº›å‚æ•°ï¼Œæ¥å—äº†è¿™äº›å‚æ•°ä¹‹åï¼Œè¯¥å‡½æ•°å¹¶ä¸ä¼šç«‹å³æ±‚å€¼ï¼Œè€Œæ˜¯ç»§ç»­è¿”å›å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œåˆšæ‰ä¼ å…¥çš„å‚æ•°åœ¨å‡½æ•°å½¢æˆçš„é—­åŒ…ä¸­è¢«ä¿å­˜èµ·æ¥ã€‚å¾…åˆ°å‡½æ•°çœŸæ­£éœ€è¦æ±‚å€¼çš„æ—¶å€™ï¼Œä¹‹å‰ä¼ å…¥çš„æ‰€æœ‰å‚æ•°éƒ½ä¼šè¢«ä¸€æ¬¡æ€§ç”¨äºæ±‚å€¼ã€‚


æ–¹ä¾¿ç†è§£
```
var add = function(x) {
  return function(y) {
    return function(z) {
      return x + y + z;
    }
  }
}

var addOne = add(1);
var addOneAndTwo = addOne(2);
var addOneAndTwoAndThree = addOneAndTwo(3);

console.log(addOneAndTwoAndThree);

es6å®ç° 
const add = x => y => z => x + y + z;
```

è®°å½•ç¨‹åºå‘˜ä¸€ä¸ªæœˆçš„åŠ ç­æ€»æ—¶é—´ï¼Œé‚£ä¹ˆå¥½ï¼Œæˆ‘ä»¬é¦–å…ˆè¦åšçš„æ˜¯è®°å½•ç¨‹åºå‘˜æ¯å¤©åŠ ç­çš„æ—¶é—´ï¼Œç„¶åæŠŠä¸€ä¸ªæœˆä¸­æ¯å¤©çš„åŠ ç­çš„æ—¶é—´ç›¸åŠ ï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªæœˆçš„åŠ ç­æ€»æ—¶é—´ã€‚
```
var monthTime = 0;

function overtime(time) {
 return monthTime += time;
}

overtime(3.5);    // ç¬¬ä¸€å¤©
overtime(4.5);    // ç¬¬äºŒå¤©
overtime(2.1);    // ç¬¬ä¸‰å¤©
//...

console.log(monthTime);    // 10.1
```

>å…¶å®æˆ‘ä»¬ä¸å¿…æ¯å¤©éƒ½è®¡ç®—åŠ ç­æ—¶é—´ï¼Œåªéœ€è¦ä¿å­˜å¥½æ¯å¤©çš„åŠ ç­æ—¶é—´ï¼Œåœ¨æœˆåº•æ—¶è®¡ç®—è¿™ä¸ªæœˆæ€»å…±çš„åŠ ç­æ—¶é—´ï¼Œæ‰€ä»¥ï¼Œå…¶å®åªéœ€è¦åœ¨æœˆåº•è®¡ç®—ä¸€æ¬¡å°±è¡Œ

```
var overtime = (function() {
  var args = [];

  return function() {
    if(arguments.length === 0) {
      var time = 0;
      for (var i = 0, l = args.length; i < l; i++) {
        time += args[i];
      }
      return time;
    }else {
      [].push.apply(args, arguments);
    }
  }
})();

overtime(3.5);    // ç¬¬ä¸€å¤©
overtime(4.5);    // ç¬¬äºŒå¤©
overtime(2.1);    // ç¬¬ä¸‰å¤©
//...

console.log( overtime() );    // 10.1
```

### äºŒã€æŸ¯é‡ŒåŒ–æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ
- 1. å‚æ•°å¤ç”¨ï¼›
- 2. æå‰è¿”å›ï¼›
- 3. å»¶è¿Ÿè®¡ç®—/è¿è¡Œã€‚

#### 2.æå‰è¿”å›

```
var addEvent = (function(){
    if (window.addEventListener) {
        return function(el, sType, fn, capture) {
            el.addEventListener(sType, function(e) {
                fn.call(el, e);
            }, (capture));
        };
    } else if (window.attachEvent) {
        return function(el, sType, fn, capture) {
            el.attachEvent("on" + sType, function(e) {
                fn.call(el, e);
            });
        };
    }
})();
```

### 3.å»¶è¿Ÿè®¡ç®—/è¿è¡Œ

```
var currying = function(fn) {
  var args = [];

  return function() {
    if (arguments.length === 0) {
      return fn.apply(this, args); // æ²¡ä¼ å‚æ•°æ—¶ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°
    } else {
      [].push.apply(args, arguments); // ä¼ å…¥äº†å‚æ•°ï¼ŒæŠŠå‚æ•°ä¿å­˜ä¸‹æ¥
      return arguments.callee; // è¿”å›è¿™ä¸ªå‡½æ•°çš„å¼•ç”¨
    }
  }
}
```
```
var cost = (function() {
  var money = 0;
  return function() {
    for (var i = 0; i < arguments.length; i++) {
      money += arguments[i];
    }
    return money;
  }
})();

var cost = currying(cost);

cost(100); // ä¼ å…¥äº†å‚æ•°ï¼Œä¸çœŸæ­£æ±‚å€¼
cost(200); // ä¼ å…¥äº†å‚æ•°ï¼Œä¸çœŸæ­£æ±‚å€¼
cost(300); // ä¼ å…¥äº†å‚æ•°ï¼Œä¸çœŸæ­£æ±‚å€¼

console.log(cost()); // æ±‚å€¼å¹¶ä¸”è¾“å‡º600
```


### ä¸‰ã€æŸ¯é‡ŒåŒ–æœ‰ç”¨å—

>1ã€ç¼–å†™å°æ¨¡å—çš„ä»£ç ï¼Œå¯ä»¥æ›´è½»æ¾çš„é‡ç”¨å’Œé…ç½®

ä½ æœ‰ä¸€ä¸ªå•†åº—ğŸ ï¼Œä½ æƒ³ç»™ä½ çš„é¡¾å®¢ 10% çš„æŠ˜æ‰£ï¼š
```
function discount(price, discount) {
    return price * discount
}
const price = discount(1500,0.10); // $150
// $1,500 - $150 = $1,350
const price = discount(2000,0.10); // $200
// $2,000 - $200 = $1,800
const price = discount(50,0.10); // $5
// $50 - $5 = $45
const price = discount(5000,0.10); // $500
// $5,000 - $500 = $4,500
const price = discount(300,0.10); // $30
// $300 - $30 = $270
```

- æŸ¯é‡ŒåŒ–ä¼˜åŒ–
```
function discount(discount) {
    return (price) => {
        return price * discount;
    }
}
const tenPercentDiscount = discount(0.1);
tenPercentDiscount(500); // $50
//å†æœ‰æŠ˜æ‰£
const twentyPercentDiscount = discount(0.2);
twentyPercentDiscount(500); // 100
// $500 - $100 = $400
twentyPercentDiscount(5000); // 1000
// $5,000 - $1,000 = $4,000
```

>2ã€é¿å…é¢‘ç¹è°ƒç”¨å…·æœ‰ç›¸åŒå‚æ•°çš„å‡½æ•°ï¼š
```
// è®¡ç®—åœ†æŸ±ä½“çš„ä½“ç§¯ï¼šç¢°å·§ï¼Œä½ çš„ä»“åº“æ‰€æœ‰çš„åœ†æŸ±ä½“é«˜åº¦éƒ½æ˜¯ 100m
function volume(l, w, h) {
    return l * w * h;
}
volume(200,30,100) // 2003000l
volume(32,45,100); //144000l
volume(2322,232,100) // 53870400l
```
```
// æŸ¯é‡ŒåŒ–è¿™ä¸ªè®¡ç®—ä½“ç§¯çš„å‡½æ•°
function volume(h) {
    return (w) => {
        return (l) => {
            return l * w * h
        }
    }
}
const hCylinderHeight = volume(100);
hCylinderHeight(200)(30); // 600,000l
hCylinderHeight(2322)(232); // 53,870,400l
```
### å››ã€æ€»ç»“
>é—­åŒ…ä½¿æŸ¯é‡ŒåŒ–åœ¨JavaScriptä¸­å¾—ä»¥å®ç°ã€‚å®ƒä¿æŒç€å·²ç»æ‰§è¡Œè¿‡çš„å‡½æ•°çš„çŠ¶æ€ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿåˆ›å»ºå·¥å‚å‡½æ•° - ä¸€ç§æˆ‘ä»¬èƒ½å¤Ÿæ·»åŠ ç‰¹å®šå‚æ•°çš„å‡½æ•°ã€‚

[JSä¸­çš„æŸ¯é‡ŒåŒ–(currying)](https://www.zhangxinxu.com/wordpress/2013/02/js-currying/)

[JavaScript-design-patterns](https://github.com/xingbofeng/JavaScript-design-patterns/blob/master/ch3-%E9%97%AD%E5%8C%85%E5%92%8C%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/ch3-%E9%97%AD%E5%8C%85%E5%92%8C%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0.md#currying)

[JavaScriptå‡½æ•°æŸ¯é‡ŒåŒ–](https://github.com/xingbofeng/xingbofeng.github.io/issues/20)

[ç†è§£JavaScriptçš„æŸ¯é‡ŒåŒ–](https://juejin.im/post/5bf18715e51d45244939acc5)